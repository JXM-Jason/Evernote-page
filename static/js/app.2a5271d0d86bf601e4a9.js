webpackJsonp([5],{CxFb:function(t,e){},EJZp:function(t,e,o){"use strict";new(o("7+uW").default)},F5VV:function(t,e,o){"use strict";var n=o("//Fk"),r=o.n(n),s=o("p+dL"),i=o("VmfC"),a={GET:"/notes/from/:notebookId",ADD:"/notes/to/:notebookId",UPDATE:"/notes/:noteId",DELETE:"/notes/:noteId"};e.a={getAll:function(t){var e=t.notebookId;return new r.a(function(t,o){Object(s.a)(a.GET.replace(":notebookId",e)).then(function(e){e.data=e.data.map(function(t){return t.createdAtFriendly=Object(i.a)(t.createdAt),t.updatedAtFriendly=Object(i.a)(t.updatedAt),t}).sort(function(t,e){return t.updatedAt<e.updatedAt}),t(e)}).catch(function(t){return o(t)})})},updateNote:function(t,e){var o=t.noteId,n=e.title,r=e.content;return Object(s.a)(a.UPDATE.replace(":noteId",o),"PATCH",{title:n,content:r})},deleteNote:function(t){var e=t.noteId;return Object(s.a)(a.DELETE.replace(":noteId",e),"DELETE")},addNote:function(t){var e=t.notebookId,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:"",content:""},n=o.title,u=void 0===n?"":n,c=o.content,d=void 0===c?"":c;return new r.a(function(t,o){Object(s.a)(a.ADD.replace(":notebookId",e),"POST",{title:u,content:d}).then(function(e){e.data.createdAtFriendly=Object(i.a)(e.data.createdAt),e.data.updatedAtFriendly=Object(i.a)(e.data.updatedAt),t(e)}).catch(function(t){o(t)})})}}},Jdfc:function(t,e){t.exports={baseURL:"//note-server.hunger-valley.com"}},NHnr:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("7+uW"),r=o("xJsL"),s=o("Dd8w"),i=o.n(s),a=o("Q98j"),u=(o("EJZp"),o("NYxO")),c={data:function(){return{}},created:function(){this.getInfo()},methods:i()({},Object(u.b)([" register","login","logout","getInfo"])),computed:i()({},Object(u.c)(["username","slug"]))},d={render:function(){var t=this.$createElement;return(this._self._c||t)("span",{attrs:{title:this.username}},[this._v(this._s(this.slug))])},staticRenderFns:[]};var l={components:{Avatar:o("VU/8")(c,d,!1,function(t){o("QTxV")},"data-v-259b5f58",null).exports},data:function(){return{}},methods:i()({},Object(u.b)([" register","logout","getInfo"]),{Logout:function(){var t=this;this.logout().then(function(){t.$router.push("/Login")})}})},f={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"sidebar"}},[e("Avatar"),this._v(" "),e("div",{staticClass:"icons"},[e("router-link",{attrs:{to:"/NotebookList",title:"笔记本"}},[e("i",{staticClass:"iconfont icon-notebook"})]),this._v(" "),e("router-link",{attrs:{to:"/NoteDetail",title:"笔记"}},[e("i",{staticClass:"iconfont icon-note"})]),this._v(" "),e("router-link",{attrs:{to:"/TrashDetail",title:"回收站"}},[e("i",{staticClass:"iconfont icon-trash"})])],1),this._v(" "),e("div",{staticClass:"logout",on:{click:this.Logout}},[e("i",{staticClass:"iconfont icon-logout"})])],1)},staticRenderFns:[]};var g={name:"App",components:{Sidebar:o("VU/8")(l,f,!1,function(t){o("xCCD")},"data-v-a404e382",null).exports,Login:r.default}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("Sidebar"),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var p=o("VU/8")(g,h,!1,function(t){o("SmaT")},null,null).exports,m=o("zL8q"),v=o.n(m),b=(o("tvR6"),o("/ocq")),k=b.a.prototype.push;b.a.prototype.push=function(t){return k.call(this,t).catch(function(t){return t})},n.default.use(b.a);var N=new b.a({routes:[{path:"/Login",name:"Login",component:function(){return new Promise(function(t){t()}).then(o.bind(null,"xJsL"))}},{path:"/",alias:"/NotebookList",name:"NotebookList",component:function(){return o.e(2).then(o.bind(null,"C3fl"))}},{path:"/NoteDetail",name:"NoteDetail",component:function(){return o.e(0).then(o.bind(null,"Gb2o"))}},{path:"/TrashDetail",name:"TrashDetail",component:function(){return o.e(1).then(o.bind(null,"WMg/"))}},{path:"*",name:"NotFound",component:function(){return o.e(3).then(o.bind(null,"YcJa"))}}]}),w=o("c1eD"),I={state:{notebookList:[],curBookId:null},getters:{notebooks:function(t){return t.notebookList},curBook:function(t){return Array.isArray(t.notebookList)?t.curBookId?t.notebookList.find(function(e){return e.id==t.curBookId})||{}:t.notebookList[0]||{}:{}}},mutations:{setNotebook:function(t,e){t.notebookList=e.notebookList},addNotebook:function(t,e){t.notebookList.push(e.notebook)},updateNotebook:function(t,e){var o=void 0;t.notebookList.find(function(t,n){(t.id=e.notebookId)&&(o=n)}),(t.notebookList[o]||[]).title=e.title},deleteNotebook:function(t,e){t.notebookList=t.notebookList.filter(function(t){return t.id!=e.notebookId}),console.log("mutation里面的deleteNotebook"),console.log(t.notebookList.filter(function(t){t.id,e.notebookId})),console.log(t.notebookList)},setCurBook:function(t,e){t.curBookId=e.curBookId,console.log("mutation的setCurBook"),console.log(t.curBookId)}},actions:{getNotebooks:function(t){var e=t.commit;return w.a.getAll().then(function(t){e("setNotebook",{notebookList:t.data})})},addNotebook:function(t,e){var o=t.commit;return w.a.addNotebook({title:e.title}).then(function(t){o("addNotebook",{notebook:t.data}),m.Message.success(t.msg)})},updateNotebook:function(t,e){var o=t.commit;return w.a.updateNotebook(e.id,{title:e.title}).then(function(t){o("updateNotebook",{notebookId:e.id,title:e.title}),m.Message.success(t.msg)})},deleteNotebook:function(t,e){var o=t.commit;return w.a.deleteNotebook(e.id).then(function(t){o("deleteNotebook",{notebookId:e.id}),m.Message.success(t.msg)})}}},E=o("F5VV"),L={state:{notes:[],curNoteId:null},getters:{notes:function(t){return t.notes},curNote:function(t){return Array.isArray(t.notes)?t.curNoteId?t.notes.find(function(e){return e.id==t.curNoteId})||{}:(console.log(t.notes),t.notes[0]||{}):{}}},mutations:{addNote:function(t,e){t.notes.push(e.note)},deleteNote:function(t,e){t.notes=t.notes.filter(function(t){return t.id!==e.noteId})},updateNote:function(t,e){var o=t.notes.find(function(t){return t.id===e.noteId})||{};o.title=e.title,o.content=e.content},getNotes:function(t,e){t.notes=e.notes},setCurNote:function(t,e){t.curNoteId=e.curNoteId}},actions:{addNote:function(t,e){var o=t.commit;return E.a.addNote({notebookId:e.notebookId},{title:e.title,content:e.content}).then(function(t){o("addNote",{note:t.data})})},deleteNote:function(t,e){var o=t.commit;return E.a.deleteNote({noteId:e.noteId}).then(function(t){o("deleteNote",{noteId:e.noteId}),m.Message.success(t.msg)})},updateNote:function(t,e){var o=t.commit,n=e.noteId,r=e.title,s=e.content;return E.a.updateNote({noteId:n},{title:r,content:s}).then(function(){o("updateNote",{noteId:n,title:r,content:s})})},getNotes:function(t,e){var o=t.commit;return E.a.getAll({notebookId:e.notebookId}).then(function(t){o("getNotes",{notes:t.data})})}}},T=o("//Fk"),A=o.n(T),j=o("p+dL"),O=o("VmfC"),_={GET:"/notes/trash",REVERT:"/notes/:noteId/revert",DELETE:"/notes/:noteId/confirm"},C=function(){return new A.a(function(t,e){Object(j.a)(_.GET).then(function(e){e.data=e.data.sort(function(t,e){return t.createdAt<e.createdAt}),e.data.forEach(function(t){t.createdAtFriendly=Object(O.a)(t.createdAt),t.updatedAtFriendly=Object(O.a)(t.updatedAt)}),t(e)}).catch(function(t){e(t)})})},D=function(t){var e=t.noteId;return Object(j.a)(_.DELETE.replace(":noteId",e),"DELETE")},y=function(t){var e=t.noteId;return Object(j.a)(_.REVERT.replace(":noteId",e),"PATCH")},F={state:{trashNotes:null,curTrashNoteId:null},getters:{trashNotes:function(t){return t.trashNotes||[]},curTrashNote:function(t,e){return t.curTrashNoteId?t.trashNotes.find(function(e){return e.id==t.curTrashNoteId})||{}:e.trashNotes[0]||{}},belongTo:function(t,e,o,n){return(n.notebooks.find(function(t){return t.id==e.curTrashNote.notebookId})||{}).title||""}},mutations:{setTrashNotes:function(t,e){t.trashNotes=e.trashNotes},addTrashNote:function(t,e){setTrashNotes.push(e.note)},deleteTrashNote:function(t,e){t.trashNotes=t.trashNotes.filter(function(t){return t.id!=e.noteId})},setCurTrashNote:function(t,e){t.curTrashNoteId=e.curTrashNoteId}},actions:{getTrashNotes:function(t){var e=t.commit;return C().then(function(t){e("setTrashNotes",{trashNotes:t.data})})},deleteTrashNote:function(t,e){var o=t.commit,n=e.noteId;return D({noteId:n}).then(function(t){o("deleteTrashNote",{noteId:n}),m.Message.success(t.msg)})},revertTrashNote:function(t,e){var o=t.commit,n=e.noteId;return y({noteId:n}).then(function(t){o("deleteTrashNote",{noteId:n}),m.Message.success(t.msg)})}}},R={user:null},x={register:function(t,e){t.user=e},login:function(t,e){t.user=e},logout:function(){R.user=null},getInfo:function(t,e){t.user=e.data}},M={state:R,getters:{username:function(t){return null===t.user?"未登录":t.user.username},slug:function(t){return null===t.user?"未":t.user.username.charAt(0)}},mutations:x,actions:{Register:function(t,e){var o=t.commit;return a.a.register({username:e.username,password:e.password}).then(function(t){o("register",{username:e.username,password:e.password}),m.Message.success(t.msg)})},Login:function(t,e){var o=t.commit;return a.a.login({username:e.username,password:e.password}).then(function(t){o("login",{username:e.username,password:e.password}),m.Message.success(t.msg)})},logout:function(t){var e=t.commit;return a.a.logout().then(function(t){e("logout"),m.Message.success(t.msg)})},getInfo:function(t){var e=t.commit;return a.a.getInfo().then(function(t){return t.isLogin&&e("getInfo",{data:t.data}),t})}}};n.default.use(u.a);var P=new u.a.Store({modules:{notebook:I,note:L,trash:F,user:M}});n.default.config.productionTip=!1,n.default.use(v.a),window.vm=new n.default({el:"#app",store:P,router:N,components:{App:p},template:"<App/>"})},Q98j:function(t,e,o){"use strict";var n=o("p+dL"),r="/auth/register",s="/auth/login",i="/auth/logout",a="/auth";e.a={register:function(t){var e=t.username,o=t.password;return Object(n.a)(r,"POST",{username:e,password:o})},login:function(t){var e=t.username,o=t.password;return Object(n.a)(s,"POST",{username:e,password:o})},logout:function(){return Object(n.a)(i)},getInfo:function(){return Object(n.a)(a)}}},QTxV:function(t,e){},SmaT:function(t,e){},VmfC:function(t,e,o){"use strict";e.a=function(t){var e=("object"===(void 0===t?"undefined":r()(t))?t:new Date(t)).getTime(),o=Date.now()-e,n="";switch(!0){case o<6e4:n="刚刚";break;case o<36e5:n=Math.floor(o/6e4)+"分钟前";break;case o<864e5:n=Math.floor(o/36e5)+"小时前";break;default:n=Math.floor(o/864e5)+"天前"}return n};var n=o("pFYg"),r=o.n(n)},c1eD:function(t,e,o){"use strict";var n=o("//Fk"),r=o.n(n),s=o("p+dL"),i=o("VmfC"),a={GET:"/notebooks",ADD:"/notebooks",UPDATE:"/notebooks/:notebookId",DELETE:"/notebooks/:notebookId"};e.a={getAll:function(){return new r.a(function(t,e){Object(s.a)(a.GET).then(function(e){e.data=e.data.sort(function(t,e){t.createdAt,e.createdAt}),e.data.forEach(function(t){t.createdAtFriendly=Object(i.a)(t.createdAt),t.updatedAtFriendly=Object(i.a)(t.updatedAt)}),t(e)}).catch(function(t){return e(t)})})},updateNotebook:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:""}).title,o=void 0===e?"":e;return Object(s.a)(a.UPDATE.replace(":notebookId",t),"PATCH",{title:o})},deleteNotebook:function(t){return Object(s.a)(a.DELETE.replace(":notebookId",t),"DELETE")},addNotebook:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:""}).title,e=void 0===t?"":t;return new r.a(function(t,o){Object(s.a)(a.ADD,"POST",{title:e}).then(function(e){e.data.createdAtFriendly=Object(i.a)(e.data.createdAt),e.data.updatedAtFriendly=Object(i.a)(e.data.updatedAt),t(e)}).catch(function(t){o(t)})})}}},"p+dL":function(t,e,o){"use strict";e.a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new r.a(function(n,r){var s={url:t,method:e,validateStatus:function(t){return t>=200&&t<300||400===t}};"get"===e.toLowerCase()?s.params=o:s.data=o,i()(s).then(function(t){200===t.status?n(t.data):(a.Message.error(t.data.msg),r(t.data))}).catch(function(t){a.Message.error("网络异常"),r({msg:"网络异常"})})})};var n=o("//Fk"),r=o.n(n),s=o("mtWM"),i=o.n(s),a=o("zL8q"),u=(o.n(a),o("Jdfc")),c=o.n(u);i.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",i.a.defaults.baseURL=c.a.baseURL,i.a.defaults.withCredentials=!0},tvR6:function(t,e){},xCCD:function(t,e){},xJsL:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("Dd8w"),r=o.n(n),s=(o("Q98j"),o("EJZp"),o("NYxO")),i={name:"Login",data:function(){return{msg:"这里是登录页面!",isShowLogin:!0,isShowRegister:!1,login:{username:"",password:"",notice:"输入用户名和密码",isError:!1},register:{username:"",password:"",notice:"创建账号后，请记住用户名和密码",isError:!1}}},methods:r()({},Object(s.b)([" Register","Login","logout","getInfo"]),{showRegister:function(){this.isShowRegister=!0,this.isShowLogin=!1,this.register.notice="创建账号后，请记住用户名和密码",this.register.isError=!1},showLogin:function(){this.isShowRegister=!1,this.isShowLogin=!0,this.login.notice="输入用户名和密码",this.login.isError=!1},onRegister:function(){return/^[\w\u4e00-\u9fa5]{3,15}$/.test(this.register.username)?/^.{6,16}$/.test(this.register.password)?(this.register.isError=!1,this.register.notice="",this.$store.dispatch("Register",{username:this.register.username,password:this.register.password}).then(function(t){console.log("resjjj"),console.log(t)}),console.log("start register..., username: "+this.register.username+" , password: "+this.register.password),void console.log("现在在注册")):(this.register.isError=!0,void(this.register.notice="密码长度为6~16个字符")):(this.register.isError=!0,void(this.register.notice="用户名3~15个字符，仅限于字母数字下划线中文"))},onLogin:function(){var t=this;return/^[\w\u4e00-\u9fa5]{3,15}$/.test(this.login.username)?/^.{6,16}$/.test(this.login.password)?(this.Login({username:this.login.username,password:this.login.password}).then(function(e){t.$router.push("/NotebookList")}).catch(function(e){t.login.isError=!0,t.login.notice="用户名或密码错误"}),void console.log("start login..., username: "+this.login.username+" , password: "+this.login.password)):(this.login.isError=!0,void(this.login.notice="密码长度为6~16个字符")):(this.login.isError=!0,void(this.login.notice="用户名3~15个字符，仅限于字母数字下划线中文"))}})},a={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"login"}},[o("div",{staticClass:"model-mask"},[o("div",{staticClass:"model-wrapper"},[o("div",{staticClass:"model-container"},[o("div",{staticClass:"main"}),t._v(" "),o("div",{staticClass:"form"},[o("h3",{on:{click:t.showRegister}},[t._v("创建账户")]),t._v(" "),o("div",{staticClass:"register",class:{show:t.isShowRegister}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.register.username,expression:"register.username"}],attrs:{type:"text",placeholder:"用户名"},domProps:{value:t.register.username},on:{input:function(e){e.target.composing||t.$set(t.register,"username",e.target.value)}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.register.password,expression:"register.password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.register.password},on:{input:function(e){e.target.composing||t.$set(t.register,"password",e.target.value)}}}),t._v(" "),o("p",{class:{error:t.register.isError}},[t._v("\n              "+t._s(t.register.notice)+"\n            ")]),t._v(" "),o("div",{staticClass:"button",on:{click:t.onRegister}},[t._v("创建账号")])]),t._v(" "),o("h3",{on:{click:t.showLogin}},[t._v("登录")]),t._v(" "),o("div",{staticClass:"login",class:{show:t.isShowLogin}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.login.username,expression:"login.username"}],attrs:{type:"text",placeholder:"输入用户名"},domProps:{value:t.login.username},on:{input:function(e){e.target.composing||t.$set(t.login,"username",e.target.value)}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.login.password,expression:"login.password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:t.login.password},on:{input:function(e){e.target.composing||t.$set(t.login,"password",e.target.value)}}}),t._v(" "),o("p",{class:{error:t.login.isError}},[t._v(t._s(t.login.notice))]),t._v(" "),o("div",{staticClass:"button",on:{click:t.onLogin}},[t._v("登录")])])])])])])])},staticRenderFns:[]};var u=o("VU/8")(i,a,!1,function(t){o("CxFb")},null,null);e.default=u.exports}},["NHnr"]);
//# sourceMappingURL=app.2a5271d0d86bf601e4a9.js.map